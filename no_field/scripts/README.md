# Scripts

The above scripts must be executed in the following order. It usually takes several hours to complete a QM/MM geometry optimisation step using ~96 cores. The wall-clock time for each simulation varies and for this reason, this scripting process has not all been automated into a single workflow.</p>

1. In the 'initial\_struc' directory containing a .pdb snapshot of solvated DNA from a molecular dynamics trajectory, run the 'set\_up\_struc.sh' script. The should create 'dna\_r.pdb', which will be the initial configuration of the reactant for the QM/MM optimisation.</br>
2. In 'a\_reac', run the 'reac\_opt.chm' input using ChemShell. This will output a log file (not included due to size limit), but a summary of the log file (\*txt), made using 'summarise\_chemsh.sh' and graphic visual 'convergence-summary.png' using 'plot\_chemsh\_summary.gp', is included. Upon completion, a QM/MM opitmised geometry given as 'dna\_r\_opt.xyz' will be obtained.</br>
3. The 'dna\_r\_opt.xyz' file does not contain any relevent information about the connectivity of the system that is given in the AMBER .prmtop, .inpcrd, and .pdb files. To start the correct conversion process, run 'sort\_pdbs\_out.sh reac' in the scripts directory. From there, run the python script 'save\_reac\_opt\_pdb\_prmtop\_inpcrd.py' to generate the AMBER ready prmtop, .inpcrd, and .pdb files for the optimised DNA reactant 'dna\_r\_opt' in the 'optimised\_struc' folder.</br>
4. Run the 'predict\_product.py' python script to automatically estimate the geometries of the double proton transfer product in the GC base pair. This is saved as 'dna\_p.pdb', 'dna\_p.prmtop' and 'dna\_p.inpcrd' in the 'initial\_struc' directory.</br>
5. In 'e\_product', run the 'prod\_opt.chm' input using ChemShell. This will output a log file (not included due to size limit), but a summary of the log file (\*txt), made using 'summarise\_chemsh.sh' and graphic visual 'convergence-summary.png' using 'plot\_chemsh\_summary.gp', is included. Upon completion, a QM/MM opitmised geometry given as 'dna\_p\_opt.xyz' will be obtained.</br>.
6. The 'dna\_p\_opt.xyz' file does not contain any relevent information about the connectivity of the system that is given in the AMBER .prmtop, .inpcrd, and .pdb files. To start the correct conversion process, run 'sort\_pdbs\_out.sh prod' in the scripts directory. From there, run the python script 'save\_prod\_opt\_pdb\_prmtop\_inpcrd.py' to generate the AMBER ready prmtop, .inpcrd, and .pdb files for the optimised DNA reactant 'dna\_p\_opt' in the 'optimised\_struc' folder.</br>
7. Now the optimised geometries for the reactant and products of the double proton transfer reaction have been obtained, the reaction coordinate is estimated using the climbing-image nudged elastic band technique. In '/neb' run the 'neb.chm' input using ChemShell.</br>
8. Once the NEB calculation has converged (feel free to check using 'summarise\_chemsh.sh'), there are X key files that will be outputted: nebpath.xyz, to visualise the atoms in the reaction coordinate, and nebinfo to see the energies in the reaction coordinate. Use the 'hart2kcal\_neb.py' python script to convert the nebinfo to kcalmol. Use the 'plot\_neb.py' python script to plot the reaction coordinate energies to 'neb\_graph.png'.</br>
9. View 'neb\_graph.png' and make a note of the frame number that correspond to a transition state(s). This frame will be used as a started point for the subsequent transition state optimisation(s). Extracted the noted frame using the 'save\_frame.tcl' script (manually modfying the frame number in the tcl when approriate) to generate 'ts1.xyz' in the 'neb' folder.</br>
10. Once again, initial estimate for the transition state, 'ts1.xyz', does not contain any relevent information about the connectivity of the system that is given in the AMBER .prmtop, .inpcrd, and .pdb files. To start the correct conversion process, run 'sort\_pdbs\_out.sh ts1\_init' in the scripts directory. From there, run the python script 'save\_ts1\_init\_pdb\_prmtop\_inpcrd.py' to generate the AMBER ready prmtop, .inpcrd and 'ts1.pdb' in the 'initial\_struc' directory.</br>
11. In the 'b\_ts1' directory run 'dimer.chm' using ChemShell. This will output a log file (not included due to size limit), but a summary of the log file (\*txt), made using 'summarise\_chemsh.sh' and graphic visual 'convergence-summary.png' using 'plot\_chemsh\_summary.gp', is included. Upon completion, a QM/MM opitmised geometry given as 'ts1\_dimer.xyz' will be obtained.</br>.
11. The optimised transition state, 'ts1\_dimer.xyz', does not contain any relevent information about the connectivity of the system that is given in the AMBER .prmtop, .inpcrd, and .pdb files. To start the correct conversion process, run 'sort\_pdbs\_out.sh ts1\_init' in the scripts directory. From there, run the python script 'save\_ts1\_opt\_pdb\_prmtop\_inpcrd.py' to generate the AMBER ready prmtop, .inpcrd and 'ts1.pdb' in the 'optimised\_struc' directory.</br>
12. The Hessian of the optimised geometry for each stationary points in the proton transfer reaction are calculated in their own subfolders in '/hess/'. Run hess.chm using chemshell.</br>
13. Copy the Hessian text files ('qts\*')to the '/rate/' directory for the respective forward and reverse subfolders and run rate.chm using ChemShell.</br>


The scripts listed in this folder 


## To summarise optimisation output logs, including NEB and dimer calculations
Although there are no ChemShell logs included in this example (they are too large) a summary of the logs (the \*txt files) are created using 'summarise\_chemsh.sh' and graphically visualised using 'plot\_chemsh\_summary.gp'
