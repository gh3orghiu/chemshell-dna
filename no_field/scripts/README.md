# Scripts

The above scripts must be executed in the following order. It usually takes several hours to complete a QM/MM geometry optimisation step using ~96 cores. The wall-clock time for each simulation varies and for this reason, this scripting process has not all been automated into a single workflow.</p>

1. In the 'rep\_101/initial\_struc' directory containing a .pdb snapshot of solvated DNA from a molecular dynamics trajectory 'rep3\_808.pdb', run the 'set\_up\_struc.sh' script. This should create 'dna\_r.pdb', which will be the initial configuration of the reactant for the QM/MM optimisation.</br>
2. In 'rep\_101/a\_reac', run the 'reac\_opt.chm' input using ChemShell. This will output a log file (not included due to size limit), but a summary of the log file (\*txt), made using 'summarise\_chemsh.sh' and a graphic visual 'convergence-summary.png' made using the gnuplot 'plot\_chemsh\_summary.gp' script, is included. Upon completion, a QM/MM optimised geometry given as 'dna\_r\_opt.xyz' will be obtained.</br>
3. The ChemShell optimised structure, 'dna\_r\_opt.xyz', does not contain any relevant information about the connectivity of the system that is given in the AMBER .prmtop, .inpcrd, and .pdb files. It is therefore necessary to run some scripts to convert this .xyz to a a format that is reasable by ChemShell and the AMBER forcefield. To start the conversion process, run 'sort\_pdbs\_out.sh reac' in the scripts directory. From there, run the python script 'save\_reac\_opt\_pdb\_prmtop\_inpcrd.py' to generate the AMBER ready prmtop, .inpcrd, and .pdb files for the optimised DNA reactant 'dna\_r\_opt' in the 'rep\_101/optimised\_struc' folder.</br>
4. Run the 'predict\_product.py' python script to automatically estimate the geometries of the double proton transfer product in the GC base pair. This is saved as 'dna\_p.pdb', 'dna\_p.prmtop' and 'dna\_p.inpcrd' in the 'rep\_101/initial\_struc' directory.</br>
5. In 'rep\_101/e\_product', run the 'prod\_opt.chm' input using ChemShell. This will output a log file (not included due to size limit), but a summary of the log file (\*txt), made using 'summarise\_chemsh.sh' and a graphic visual 'convergence-summary.png' made using the gnuplot 'plot\_chemsh\_summary.gp' script, is included. Upon completion, a QM/MM optimised geometry given as 'dna\_p\_opt.xyz' will be obtained.</br>
6. Convert 'dna\_p\_opt.xyz' to the AMBER .prmtop, .inpcrd, and .pdb files using 'sort\_pdbs\_out.sh prod' and 'save\_prod\_opt\_pdb\_prmtop\_inpcrd.py'. This will generate  AMBER ready prmtop, .inpcrd, and .pdb files for the optimised DNA reactant 'dna\_p\_opt' in the 'optimised\_struc' folder.</br>
7. Now the optimised geometries for the reactant and products of the double proton transfer reaction have been obtained, the reaction coordinate is estimated using the climbing-image nudged elastic band technique. In 'rep\_101/neb' run the 'neb.chm' input using ChemShell.</br>
8. Once the NEB calculation has converged (feel free to check using 'summarise\_chemsh.sh'), there are two important files that will be generated: 'nebpath.xyz', to visualise the atoms in the reaction coordinate, and 'nebinfo' to see the energies in the reaction coordinate. Use the 'hart2kcal\_neb.py' python script to convert 'nebinfo' from Hartrees to kcal/mol. Use the 'plot\_neb.py' python script to plot the reaction coordinate energies to 'neb\_graph.png'.</br>
9. View 'neb\_graph.png', and make a note of the frame number that corresponds to a transition state(s). This frame will be used as a started point for the subsequent transition state optimisation(s). Extract the previously noted frame using the 'save\_frame.tcl' script (manually modifying the frame number in the tcl script when appropriate) to generate 'ts1.xyz' in the 'rep\_101/neb' folder.</br>
10. Once again, the initial estimate for the transition state, 'ts1.xyz', does not contain any relevant information about the connectivity of the system that is given in the AMBER .prmtop, .inpcrd, and .pdb files. To start the correct conversion process, run 'sort\_pdbs\_out.sh ts1\_init' in the scripts directory followed by the python script 'save\_ts1\_init\_pdb\_prmtop\_inpcrd.py' to generate the AMBER ready prmtop, .inpcrd and 'ts1.pdb' in the 'rep\_101/initial\_struc' directory.</br>
11. In the 'rep\_101/b\_ts1' directory run 'dimer.chm' using ChemShell. This will output a log file (not included due to size limit), but a summary of the log file (\*txt), made using 'summarise\_chemsh.sh' and graphic visual 'convergence-summary.png' using 'plot\_chemsh\_summary.gp', is included. Upon completion, a QM/MM optimised geometry given as 'ts1\_dimer.xyz' will be obtained.</br>.
11. The optimised transition state, 'ts1\_dimer.xyz', does not contain any relevant information about the connectivity of the system that is given in the AMBER .prmtop, .inpcrd, and .pdb files. To start the correct conversion process, run 'sort\_pdbs\_out.sh ts1\_init' in the scripts directory. From there, run the python script 'save\_ts1\_opt\_pdb\_prmtop\_inpcrd.py' to generate the AMBER ready prmtop, .inpcrd and 'ts1.pdb' in the 'optimised\_struc' directory.</br>
12. The Hessian of the optimised geometry for each stationary points in the proton transfer reaction are calculated in their own subfolders in 'rep\_101/hess/{a,b,e}'. Run hess.chm using ChemShell.</br>
13. Copy the Hessian text files ('qts\*')to the '/rate/{k1f,k1r}' directory for the respective forward and reverse subfolders and run rate.chm using ChemShell.</br>


## To summarise optimisation output logs, including NEB and dimer calculations
Although there are no ChemShell logs included in this example (they are too large) a summary of the logs (the \*txt files) are created using 'summarise\_chemsh.sh' and graphically visualised using 'plot\_chemsh\_summary.gp'
